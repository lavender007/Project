!function(){"use strict";function t(){return Ft}function e(t){t||(t={});const e={};for(const s of Object.keys(Nt))void 0!==t[s]&&(e[s]=t[s]);const n=["echoUrl"];for(const s of n)void 0!==t[s]&&(e[s]=t[s]);const r=1===Object.keys(e).length&&void 0!==e.echoUrl;var i;qt=r?{...qt,...e}:{...Nt,...e,trackingLevel:e.trackingLevel??Nt.trackingLevel},qt.autoPageView=(i=e)&&"boolean"==typeof i.autoPageView?i.autoPageView:(null==i?void 0:i.oirtyp)!==yt.t&&(null==i?void 0:i.oirtyp)!==yt.i&&Nt.autoPageView,Ft=!0}function n(t){if(!t)return;const e={};for(const r of Object.keys(Nt))void 0!==t[r]&&(e[r]=t[r]);const n=["echoUrl"];for(const r of n)void 0!==t[r]&&(e[r]=t[r]);qt={...qt,...e,trackingLevel:e.trackingLevel??qt.trackingLevel}}function r(){return qt}function i(){try{const t=Ve.o(ae);if(!t)return null;const e=Pt(t);return JSON.parse(e).$exchange_id||null}catch{return null}}function s(){var t,e;try{const n=Ve.u(le);if(n)return n;const r=null==(e=null==(t=window.exponea)?void 0:t.configuration)?void 0:e.customer;return(null==r?void 0:r.registered)&&(null==r?void 0:r.cookie)?r.cookie:null}catch{return null}}function o(t,e,n={}){try{return t()}catch(r){return function(t,e={},n){try{const e=t instanceof Error?t.message:String(t),r=function(t){try{return t instanceof TypeError&&t.message.includes("fetch")||t instanceof Error&&t.message.includes("validation")?"warn":t instanceof Error&&t.message.includes("critical")?"error":"warn"}catch{return"error"}}(t);return{success:!1,data:n,error:e,severity:r}}catch(r){return{success:!1,data:n,error:"Unknown error occurred",severity:"error"}}}(r,n,e).data}}function c(t,e=0){return o(()=>{if("number"==typeof t)return t;if(!t||"string"!=typeof t)return e;const n=t.trim();if(""===n)return e;const r=parseInt(n,10);return isNaN(r)?e:r},e,{})}async function a(t,e=_t){try{if(t<0)return;const n=t*(e===_t?1e3:1);return new Promise(t=>Ot(t,n))}catch(n){}}function u(t){return Le&&!t||(Le=new Ue(t)),Le}function l(t,e){try{if(!t||"string"!=typeof t)return;ze[t]=e}catch(n){}}function h(t){Ne.l(t)}async function f(t,e={}){const n=new AbortController,r=Ot(()=>n.abort(),e.timeout||1e4);try{const i=await((t,e)=>{if("undefined"==typeof fetch)throw new Error("Fetch API not available");return fetch(t,e)})(t,{...e,credentials:"include",signal:n.signal});return xt(r),i}catch(i){throw xt(r),i}}async function d(t,e,n,i,s=!0){const c=function(t){const e=r(),n=(null==e?void 0:e.brandedLinkDomain)||"oirt.aggle.net",i=t||"/evt",s=i.startsWith("/")?i:`/${i}`;return c=`${n}${s}`,o(()=>{var t;if(!Te(c)||!je(c))return"";const e=c.includes("localhost")||c.includes("127.0.0.1"),n="undefined"!=typeof globalThis?null==(t=globalThis.process)?void 0:t.env:void 0,r="development"===(null==n?void 0:n.NODE_ENV);return e?`http://${c.replace(/^(https?):\/\//,"").replace(/\/$/,"")}`:r?c.startsWith("http://")||c.startsWith("https://")?c.replace(/\/$/,""):`https://${c}`.replace(/\/$/,""):`https://${c.replace(/^(https?):\/\//,"")}`.replace(/\/$/,"")},"",{});var c}(t),a=$t(e),u="string"==typeof a?(new TextEncoder).encode(a).length:0,l={...n},h=(i.h??!1)&&u<=64e3,d=()=>{s&&qe._({p:t,m:e,S:n,k:i})};try{const t=await _(async()=>await f(c,{method:"POST",headers:{"Content-Type":"application/json",...l},body:a,keepalive:h,timeout:i.$}),i.I??3,i.D??i.T??3e3);if(t.ok)return t;if(t.status>=500||0===t.status)throw s&&d(),new Error(`OIR request failed with status ${t.status}: ${t.statusText}`);return t}catch(y){throw s&&function(t){return t instanceof Error&&!t.message.includes("OIR request failed")}(y)&&d(),y}}function y(t){return t instanceof Error?t:new Error(String(t))}async function _(t,e=3,n=3e3,r=!0){let i;for(let o=1;o<=e;o++)try{return await t()}catch(s){if(i=s,i.message.includes("Invalid response format"))break;if(!(o<e&&r))break;{const t=n*Math.pow(2,o-1);await new Promise(e=>Ot(e,t))}}throw new Error(`Failed after ${e} attempts: ${null==i?void 0:i.message}`)}async function w(t,e={},n){try{const s=await async function(t,e){let n={};Be&&(n=await Be.j());const r={...ze};return{ref_ids:n,session:function(){const t=Ne.C(),e=Ne.O(),n={page_views:t.page_views,time_on_site:t.time_on_site,start_time:t.start_time,last_activity:t.last_activity,referer_url:t.referer_url,referer_title:t.referer_title};return 1!==e&&t.browser_metadata&&(n.browser_metadata=t.browser_metadata),n}(),custom:{...r,...(null==e?void 0:e.custom)||{}},event:t}}(e,n),o=t.startsWith("/")?t.slice(1):t,c=function(t=!1){let e,n;try{e=r()}catch{e={}}try{n=D()}catch{n=null}if(!n&&!t)throw new Error("UserId missing for tracking request");const i={"X-Reference-Pid":"string"==typeof e.oirid?e.oirid:"OIRDEMO","X-Reference-Ptyp":"string"==typeof e.oirtyp?e.oirtyp:"unknown","X-Reference-OirVersion":ct()};return n&&(i["X-Reference-Uid"]=n),i}(Array.from(Fe).includes(o)),a={data:g($t(s))},u=function(t){return{...Ye,$:(null==t?void 0:t.timeout)||Ye.$,I:(null==t?void 0:t.retries)||Ye.I,D:(null==t?void 0:t.retryInterval)||Ye.D,h:(null==t?void 0:t.keepalive)??Ye.h}}(n),l={"Content-Type":"application/json",...c,...null==n?void 0:n.headers},h=await d(t,a,l,u);if(null==h?void 0:h.ok){let t;if(204===h.status)t=null;else{const e=await h.json();t=e&&e.data||null}let e=t;if(t)try{const n=v(t);e=null===n?t:n}catch(i){e=t}return null!==e?{success:!0,response:e}:{success:!0}}return{success:!1,error:`HTTP ${(null==h?void 0:h.status)||Rt}`}}catch(s){return{success:!1,error:s instanceof Error?s.message:String(s)}}}async function p(t,e){try{const n=ct(),i={message:t,tag:`${e||"sdk"}-${n}-${r().oirid||"unknown"}`,v:n};return await w("jlg",i)}catch(n){return{success:!1,error:n instanceof Error?n.message:String(n)}}}function g(t){try{const e=String(t);if(0===e.length)return Mt(String.fromCharCode(0));const n=Qe,r=(new TextEncoder).encode(n),i=(new TextEncoder).encode(e),s=Math.floor(256*Math.random()),o=new Uint8Array(i.length+1);o[0]=s;for(let t=0;t<i.length;t++)o[t+1]=i[t]^r[t%r.length]^s;const c=8192;let a="";for(let t=0;t<o.length;t+=c){const e=o.slice(t,t+c);a+=String.fromCharCode(...e)}return Mt(a)}catch(e){throw p(`encryption_encode_failed: ${e instanceof Error?e.message:String(e)}`,"encryption"),e}}function v(t){try{if(!t)return null;let n;try{n=Pt(t)}catch(e){throw p(`encryption_decode_failed: ${e instanceof Error?e.message:String(e)}`,"encryption"),new Error("Invalid base64 data - cannot decode")}const r=new Uint8Array(n.split("").map(t=>t.charCodeAt(0)));if(1===r.length&&0===r[0])return"";const i=r[0],s=new Uint8Array(r.length-1),o=Qe,c=(new TextEncoder).encode(o);for(let t=0;t<s.length;t++)s[t]=r[t+1]^c[t%c.length]^i;return(new TextDecoder).decode(s)}catch(e){throw p(`encryption_decode_failed: ${e instanceof Error?e.message:String(e)}`,"encryption"),e}}function m(t,e=!0){try{if(!t)return null;let n;return n=e?t.startsWith("encoded_")?v(t.substring(8)):v(t):t,n?kt(n):null}catch(n){return p(`utils_json_decode_failed: ${n instanceof Error?n.message:String(n)}`,"encryption"),null}}function b(t){try{if("undefined"==typeof document)return null;const e=function(){if(Ke)return Ke;Ke=new Map;try{const t="undefined"==typeof document?"":document.cookie;if(t){const e=t.split(";");for(const t of e){const e=t.indexOf("=");if(e>0){const n=t.substring(0,e).trim(),r=t.substring(e+1).trim();Ke.set(n,r)}}}}catch{}return Je||(Je=!0,queueMicrotask(()=>{Ke=null,Je=!1})),Ke}().get(t);return e?At(e):null}catch{return null}}function S(){return"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:{}}function E(t,e,n,r=36e5){var i,s;try{const o=Date.now()+r,c=$t({value:e,expires:o});if(n)try{return null==(i=S().localStorage)?void 0:i.setItem(t,c),!0}catch{try{null==(s=S().localStorage)?void 0:s.removeItem(t)}catch{}}return He[t]=c,!0}catch(o){return!1}}function k(t){return function(t){return new tn(t)}({taskId:t.taskId,timeout:t.timeout})}function $(){return sn??(sn=k(rn))}function I(t){if(!t||"string"!=typeof t)return;const e=null!==en;en=t,Ut.M("User ID found in cache",{userId:`${t.substring(0,8)}...`}),e||nn.forEach(e=>{try{e(t)}catch(n){}})}function D(){return en}function T(){en=null}async function j(){return await $().P()}async function C(t){try{if(t){if(await $().P())return;await $().A()}else await $().U(),$().L()}catch(e){}}async function O(){try{const t=Ve.o(Bt);if(t)return Ut.M(Lt,{userId:`${t.substring(0,8)}...`}),t;const e=await $().R();return e.success&&e.data&&"string"==typeof e.data?(Ut.M(Lt,{userId:`${e.data.substring(0,8)}...`,source:"cross-tab sync"}),e.data):null}catch(t){return null}}async function x(t){try{await $().N(t),Ut.M("User ID initialization successful",{userId:`${t.substring(0,8)}...`})}catch(e){}}function M(t){const e=Date.now()-2592e5;return t.filter(t=>{try{const n=new Date(t.time).getTime();return n>=e&&!isNaN(n)}catch{return!1}})}function P(){if(!un&&0!==cn.length){un=!0;try{let t=Ve.o(Zt)||[];t=M(t);const e=[...t,...cn];if(e.length>on){const t=e.length-on;e.sort((t,e)=>{try{return new Date(t.time).getTime()-new Date(e.time).getTime()}catch{return 0}}),e.splice(0,t)}Ve.q(Zt,e),cn=[]}catch(t){if(t instanceof Error&&"QuotaExceededError"===t.name)try{const t=Ve.o(Zt)||[];if(t.length>0){const e=Math.max(1,Math.floor(.1*t.length));t.splice(0,e),Ve.q(Zt,t),P()}}catch(e){}}finally{un=!1}}}function A(t){(function(){if(ln||"undefined"==typeof window)return;ln=!0;const t=()=>{if(cn.length>0)try{const e="undefined"==typeof window?null:(null==(t=window.localStorage)?void 0:t.getItem(Zt))??null;let n=e?kt(e):[];n=M(n);const r=[...n,...cn];r.length>on&&(r.sort((t,e)=>{try{return new Date(t.time).getTime()-new Date(e.time).getTime()}catch{return 0}}),r.splice(0,r.length-on)),((t,e)=>{var n;"undefined"!=typeof window&&(null==(n=window.localStorage)?void 0:n.setItem(t,e))})(Zt,$t(r)),cn=[]}catch(e){}var t};Dt("beforeunload",t),Dt("pagehide",t),Dt("visibilitychange",()=>{if("hidden"===document.visibilityState&&cn.length>0)try{P()}catch{}})})(),cn.push(t),cn.length>=3?(null!==an&&(xt(an),an=null),P()):(null!==an&&(xt(an),an=null),an=Ot(()=>{try{P()}catch(t){}an=null},3e3))}function U(t=100){P();try{const e=Ve.o(Zt);let n=e||[];if(n=M(n),n.length!==((null==e?void 0:e.length)||0))try{Ve.q(Zt,n)}catch{}const r=n.slice(0,t),i=n.slice(t);return{events:r,deleteCallback:()=>{try{i.length>0?Ve.q(Zt,i):Ve.F(Zt)}catch(t){}}}}catch(e){return{events:[],deleteCallback:()=>{}}}}function L(){null!==an&&(xt(an),an=null),cn=[];try{Ve.F(Zt)}catch(t){}}function z(){try{const[t,e,n]=Ve.B([ne,te,Bt]);return t||(e&&!n?(Ve.q(Bt,e),e):!e&&n?(Ve.q(te,n),n):(e&&n&&e!==n&&Ve.q(Bt,e),e||n))}catch(t){return null}}function R(t){try{const e=Ve.o(t);return"true"===e||"1"===e}catch(e){return!1}}function N(t,e){try{return Ve.q(`${de}${t}`,e)}catch(n){return!1}}function q(){try{const t=Ve.Y().filter(t=>t.startsWith(fe)||t.startsWith(he)||t.startsWith(de));if(0===t.length)return!0;let e=!0;for(const n of t)Ve.F(n)||(e=!1);return e}catch(t){return!1}}function F(t){try{const e=Object.keys(t);if(e.length>0)for(const n of e)l(n,t[n])}catch(e){p(`debug_invalid_oirtyp: ${e instanceof Error?e.message:String(e)}`,"command-handlers")}}function B(t){return t.user_properties&&"object"==typeof t.user_properties?t.user_properties:t}async function Y(t,e,n){if(!t)return{success:!1,error:"SDK not initialized"};const r=await w("/up",e,n);return r.success?{success:!0}:(r.error&&r.error.includes("UserId missing"),{success:!1,...r.error?{error:r.error}:{}})}async function Q(t,e,n){if(!t)return{success:!1,error:"SDK not initialized"};const r=await w("/evt",e,n);return r.success?{success:!0}:(r.error&&r.error.includes("UserId missing"),{success:!1,...r.error?{error:r.error}:{}})}async function K(t,e){try{if(!t||"string"!=typeof t)return{success:!1,error:"Shopify track command requires event name as string"};const n=t;if(!n.startsWith("shopify-"))return{success:!1,error:'Shopify track command requires event name starting with "shopify-"'};if(!e||"object"!=typeof e||Array.isArray(e))return{success:!1,error:"Shopify track command requires options object with store_handle and data"};const r=e.store_handle,i=e.data;return r&&"string"==typeof r?!i||"object"!=typeof i||Array.isArray(i)?{success:!1,error:"Shopify track command requires data as object"}:(await Oe.K(n,r,i),{success:!0}):{success:!1,error:"Shopify track command requires store_handle as string"}}catch(n){return{success:!1,error:n instanceof Error?n.message:Rt}}}function J(t){(async function(t){if(!It(t)||t.length<2)return;const[e,n]=t;if(e===vt||e===mt);else{if(e!==bt)return;if("string"!=typeof n||!n.startsWith("shopify-"))return}const r={id:`${Date.now()}-${Math.random().toString(36).substring(2,15)}`,actionArray:t,time:(new Date).toISOString()};try{A(r)}catch(i){}})(t).catch(()=>{})}async function H(t,e){if(!It(e)||e.length<2)return{success:!1,error:"Invalid action array"};const[n,r,i]=e;try{if(n===vt){if(!r||"object"!=typeof r||Array.isArray(r))return{success:!1,error:"Invalid event data"};const e=i;return await Q(t,r,e)}if(n===mt){if(!r||"object"!=typeof r||Array.isArray(r))return{success:!1,error:"Invalid identify data"};const e=B(r),n=i;return await Y(t,e,n)}return n===bt?"string"==typeof r&&r.startsWith("shopify-")?await K(r,i):{success:!1,error:"Non-Shopify track action should be normalized to event format"}:{success:!1,error:`Unknown action type: ${n}`}}catch(s){return{success:!1,error:s instanceof Error?s.message:Rt}}}function G(t){return It(t)&&t.length>=2&&(t[0]===vt||t[0]===mt||t[0]===bt)}function V(t){if(!It(t)||t.length<2)return t;const[e,n,r,i]=t;if(e!==bt)return t;if("string"!=typeof n)return t;if(n.startsWith("shopify-"))return t;const s={event:n};r&&"object"==typeof r&&!Array.isArray(r)&&(s.payload=r),"on-site"===n&&r&&"object"==typeof r&&!Array.isArray(r)&&F(r);const o=[vt,s];return void 0!==i&&o.push(i),o}function X(t,e){const[n,r,i]=e,s=n,o=pn[s];return o?(o(t,r,i),void 0):s===gt?(!function(t,e,n){"string"==typeof t&&n.length>=3?F({[t]:e}):"object"==typeof t&&null!==t&&F(t)}(r,i,e),void 0):s===bt?(!function(t,e){"string"==typeof t&&t.startsWith("shopify-")&&K(t,e).catch(()=>{})}(r,i),void 0):s===vt?(!function(t,e,n){t.J&&e&&"object"==typeof e&&!Array.isArray(e)&&Q(t.J,e,n).catch(()=>{})}(t,r,i),void 0):void 0}function W(t,e={}){var n,r;try{if(!t||"undefined"==typeof document)return!1;if(e.customInsertion)return e.customInsertion(t),Ut.M(zt,{type:t.tagName.toLowerCase(),method:"custom"}),!0;const i=e.target||("undefined"==typeof document?null:document.body);if(!i)return!1;const s=e.position||"append";switch(s){case"prepend":i.insertBefore(t,i.firstChild);break;case"before":e.target?null==(n=e.target.parentNode)?void 0:n.insertBefore(t,e.target):i.appendChild(t);break;case"after":e.target?null==(r=e.target.parentNode)?void 0:r.insertBefore(t,e.target.nextSibling):i.appendChild(t);break;default:i.appendChild(t)}return Ut.M(zt,{type:t.tagName.toLowerCase(),position:s}),!0}catch(i){return p(`pixel_element_insertion_failed: ${i instanceof Error?i.message:String(i)}`,"element-utils"),!1}}function Z(t){try{return!(!t||!t.parentNode||(t.parentNode.removeChild(t),Ut.M("Pixel element removed successfully",{type:t.tagName.toLowerCase()}),0))}catch(e){return p(`pixel_element_removal_failed: ${e instanceof Error?e.message:String(e)}`,"element-utils"),!1}}function tt(){return Tn??(Tn=k(Dn))}function et(){return xn??(xn=k(On))}function nt(){return Un??(Un=k(An))}async function rt(){return(await async function(t=!1){return bn.V(void 0).G(t)}(!1)).H}async function it(){try{Nn.getInstance().W().X();const t=await jn.Z();t&&(!function(){try{Ln.tt(),Ln.et().catch(t=>{p(`active_onsite_event_failed: ${t instanceof Error?t.message:String(t)}`,"initialization")})}catch(t){p(`active_onsite_event_failed: ${t instanceof Error?t.message:String(t)}`,"initialization")}}(),function(){try{const t=(Pn||(Pn=new Mn),Pn);t.tt(),t.nt()}catch(t){p(`identity_ack_error: ${t instanceof Error?t.message:String(t)}`,"initialization")}}(),await async function(t){try{const{rt:e}=await Promise.resolve().then(()=>Zn);await e.it(t)}catch(e){p(`sync_error: ${e instanceof Error?e.message:String(e)}`,"initialization")}}(t))}catch(t){p(`sync_error: ${t instanceof Error?t.message:String(t)}`,"initialization")}}async function st(){try{const t=r();if(!t.echoUrl)return;const e=t.brandedLinkDomain;if(e&&t.echoUrl===`${e}/echo`)return;await yn.st(t.echoUrl)}catch(t){p(`echo_id_trigger_failed: ${t instanceof Error?t.message:String(t)}`,"initialization")}}function ot(){if("undefined"==typeof window||"undefined"==typeof document)return{page:"",title:"",referrer:""};const t=Ne.C(),e={page:t.referer_url,title:t.referer_title,referrer:jt()};try{"undefined"!=typeof window&&window.innerWidth&&window.innerHeight&&(e.viewport={width:window.innerWidth,height:window.innerHeight})}catch(n){}return e}function ct(){try{return"260214"}catch(t){return Fn}}function at(){return Nn.getInstance()}function ut(t){const e=at();if(!It(t))return;const n=t[0];if("addEventListener"===n&&t.length>=3){const e=t[1],n=t[2];if("string"==typeof e&&"function"==typeof n)return fn.ot(e,n),void 0}if("removeEventListener"===n&&t.length>=3){const e=t[1],n=t[2];if("string"==typeof e&&"function"==typeof n)return fn.ct(e,n),void 0}e.W().ut(t)}function lt(){for(const t of Bn)ut(t);Bn.length=0}function ht(){for(const{type:t,listener:e}of Yn)fn.ot(t,e);Yn.length=0}async function ft(){try{if(!t())return;if(!qt.oirid||!qt.oirtyp)return;await async function(){const t=Nn.getInstance(),e=r();e&&await t.tt(e)}()}catch(e){}}const dt="_oirtrk",yt={lt:"6311ae17",t:"48b1feaa",i:"4abc4e11"},_t="seconds",wt="milliseconds",pt="cfg",gt="set",vt="event",mt="identify",bt="track",St="addEventListener",Et="removeEventListener",kt=JSON.parse,$t=JSON.stringify,It=Array.isArray,Dt=(t,e)=>{"undefined"!=typeof window&&window.addEventListener(t,e)},Tt=(t,e)=>{"undefined"!=typeof window&&window.removeEventListener(t,e)},jt=()=>"undefined"==typeof document?"":document.referrer||"",Ct=t=>{"undefined"!=typeof document&&(document.cookie=t)},Ot=(t,e)=>{if("undefined"==typeof setTimeout)throw new Error("setTimeout not available");return setTimeout(t,e)},xt=t=>{"undefined"!=typeof clearTimeout&&clearTimeout(t)},Mt=t=>{if("undefined"==typeof btoa)throw new Error("btoa not available");return btoa(t)},Pt=t=>{if("undefined"==typeof atob)throw new Error("atob not available");return atob(t)},At=t=>decodeURIComponent(t),Ut={M:function(){},ht:function(){},ft:function(){},yt:function(){}},Lt="Received user ID from another tab",zt="Pixel element inserted successfully",Rt="Unknown error",Nt={oirid:"",oirtyp:yt.lt,brandedLinkDomain:"oirt.aggle.net",timeout:1e4,retry:{maxAttempts:3,backoffMs:1e3},trackingLevel:1,autoPageView:!0};let qt={...Nt},Ft=!1;const Bt="__uidcei",Yt="__uidtkci",Qt="__b6m4cs",Kt="__s3n8cs",Jt="__refp2oloirel",Ht="__sstst",Gt="__spvws",Vt="__slpv",Xt="_oir_ost_ts",Wt="_oir_ost_compl",Zt="oir-event-cache",te="osid",ee="oscid",ne="osxid",re="osxcid",ie="cart",se="__prev_cart",oe="_shopify_y",ce="_shopify_client_id",ae="__kla_id",ue="__blr_id",le="__exponea_etc__",he="__oir_dom_event_",fe="__oir_event_history_",de="__oir_listeners_",ye=new Set([Bt,Yt,"__ustcel","__idceich","__subscou","__spfccou",se,"__shpfy","__klvsckey","__bloomsckey",Qt,"__blr_exchange_id","__sendlsckey",Kt,"__yotpsckey","__ckschci","__tcfgci",Jt,Ht,Gt,Vt,Xt,Wt,Zt]),_e=new Set([te,ee,ne,re,"__fpcsnc","__blrcsnc"]),we=new Set([ie,oe,ce,ae,ue,le]),pe=new Set(["__nopgsc2iu","__tostos","__fvots","_oir_csc_dt","__lcfgts","__ostlfts"]),ge=new Set([Bt]),ve=new Set([...ye,...pe,..._e,...we]);class me{constructor(t,e){if(!t)throw new Error("Storage manager is required");this._t=t,this.wt=e}gt(){const t={};for(const e of this.wt){if(!ve.has(e))continue;const n=this.vt(e);n&&"string"==typeof n&&""!==n.trim()&&(t[e]=n)}return t}vt(t){try{return this._t.o(t)}catch(e){return null}}}class be{constructor(t){this.wt=t}async bt(){const t={};try{if("undefined"==typeof window||!window.location)return t;const e=(t=>{if("undefined"==typeof URLSearchParams)throw new Error("URLSearchParams not available");return new URLSearchParams(t)})("undefined"!=typeof window&&window.location?window.location.search:"");for(const[n,r]of e.entries())""!==r.trim()&&this.wt.includes(n)&&(t[n]=r)}catch(e){}return t}}const Se="shopify-product_viewed",Ee="shopify-checkout_started",ke="shopify-checkout_completed",$e=[Se,ke,Ee],Ie="/swe",De="/s9p1/evt",Te=t=>"string"==typeof t,je=t=>"string"==typeof t&&t.trim().length>0,Ce={current:null},Oe=new class{constructor(){this.K=async(t,e,n)=>{try{t===Ee&&this.St(n),t===Se&&this.Et(n);let r=await this.kt();const i=await this.$t();!r&&i&&t===ke&&(r=i),r&&i!==r&&await this.It(r);const s=this.Dt(),o=this.Tt(),c={store_handle:e,...r&&{cart_token:r},...s&&{referer_url:s},...o&&{referer_title:o}},a={event:t,data:n};await this.jt(t,a,c)}catch(r){throw await Ut.ht(r.message,$e.includes(t)?De:Ie),r}}}St(t){var e,n;const r=t.checkout;if(null==r?void 0:r.lineItems)for(const i of r.lineItems)if(null==(n=null==(e=i.variant)?void 0:e.image)?void 0:n.src){const t=new URL(i.variant.image.src),e=t.pathname.substring(0,t.pathname.lastIndexOf("."));if(/_\d+x\d+$/.test(e)){const n=t.pathname.substring(t.pathname.lastIndexOf(".")+1);i.variant.image.src=`${t.origin}${e.substring(0,e.lastIndexOf("_"))}.${n}${t.search}`}}}Et(t){var e;const n=t.productVariant;(null==(e=null==n?void 0:n.image)?void 0:e.src)&&(n.image.src=`https://${n.image.src.replace(/^(https?)?:?\/\//,"")}`.replace(/\/$/,""))}async kt(){try{return Ve.o(ie)||void 0}catch(t){return p(`failed to retrieve cart token from stora: ${t instanceof Error?t.message:String(t)}`,"shopify"),void 0}}Dt(){const t=r();return"object"==typeof t&&null!==t&&"referer_url"in t&&"string"==typeof t.referer_url?t.referer_url:this.Ct}Tt(){const t=r();return"object"==typeof t&&null!==t&&"referer_title"in t&&"string"==typeof t.referer_title?t.referer_title:this.Ot}async jt(t,e,n){const r=$e.includes(t)?De:Ie,i=await w(r,e,{custom:n});if(!i.success)throw new Error(`Failed to send Shopify tracking request: ${i.error}`)}async $t(){try{return Ve.o(se)||void 0}catch(t){return p(`failed to read previous cart token from : ${t instanceof Error?t.message:String(t)}`,"shopify"),void 0}}async It(t){try{Ve.q(se,t)}catch(e){p(`failed to write previous cart token to s: ${e instanceof Error?e.message:String(e)}`,"shopify")}}xt(){try{const t=Ve.o(oe);return t&&"string"==typeof t&&""!==t.trim()?t:null}catch(t){return null}}Mt(){var t,e,n,r;try{const i=window;if(null==(e=null==(t=i.trekkie)?void 0:t.config)?void 0:e.initialDocumentCookie){const t=function(t,e){try{if("string"!=typeof e)return null;const n=e.split(";");for(const e of n){const n=e.trim();if(n.startsWith(`${t}=`)){const t=n.substring(11);return t?At(t):null}}return null}catch(n){return null}}(oe,null==(r=null==(n=i.trekkie)?void 0:n.config)?void 0:r.initialDocumentCookie);if(t)return t}return null}catch(i){return null}}Pt(){var t,e,n;try{return(null==(n=null==(e=null==(t=window.trekkie)?void 0:t.trekkie)?void 0:e.defaultAttributes)?void 0:n.uniqToken)||null}catch(r){return null}}At(){var t,e,n,r;try{return(null==(r=null==(n=null==(e=null==(t=window.trekkie)?void 0:t.integrations)?void 0:e.find(t=>{var e;return"checkout"===(null==(e=null==t?void 0:t.defaultAttributes)?void 0:e.appName)}))?void 0:n.defaultAttributes)?void 0:r.uniqToken)||null}catch(i){return null}}Ut(){try{const t=Ve.o(ce);return t&&"string"==typeof t&&""!==t.trim()?t:null}catch(t){return null}}Lt(){let t;if("undefined"!=typeof window&&void 0!==window.performance)try{const e=/^https?:\/\/([^/]+)(\/api\/(?:unstable|2\d{3}-\d{2})\/graphql\.json(?=$|\?))?/,n=performance.getEntriesByType("resource");let r;for(let t=n.length-1;t>=0;t--){const i=n[t];if("fetch"!==i.initiatorType)continue;const s=window.location.host,o=i.name.match(e);if(!o)continue;const[,c,a]=o;if(c===s||a&&(null==c?void 0:c.endsWith(`.${s}`))){const t=this.zt(i);if(t){r=t;break}}}if(r&&(t=r),t?Ce.current=t:Ce.current&&(t=Ce.current),!t){const e=performance.getEntriesByType("navigation")[0];t=this.zt(e,!1)}}catch(e){p(`failed to get tracking values: ${e instanceof Error?e.message:String(e)}`,"shopify")}return t}zt(t,e=!0){if(!t)return;let n="",r="",i="";const s=t.serverTiming;if(s&&s.length>=3)for(let o=s.length-1;o>=0;o--){const{name:t,description:e}=s[o];if(t&&e&&("_y"===t?n=e:"_s"===t?r=e:"_cmp"===t&&(i=e),n&&r&&i))break}return n&&r&&(!e||i)?{uniqueToken:n,visitToken:r,consent:i}:void 0}};class xe{async Rt(){var t;try{return((null==(t=Oe.Lt())?void 0:t.uniqueToken)??Oe.xt()??Oe.Mt()??Oe.Pt()??Oe.At()??Oe.Ut())||null}catch(e){return null}}async Nt(){try{const t=await this.Rt();return t?{[oe]:t}:{}}catch(t){return{}}}async qt(){const t={},e=await this.Nt();return Object.assign(t,e),t}}const Me=[te,ee,ne,re,ie,se,ae,ue],Pe=["_kx"],Ae={enabled:!0,includeEmpty:!1,maxRefIds:20,maintainInternalPool:!0};class Ue{constructor(t=Ae){this.Ft=null,this.Bt={...Ae,...t},null===this.Bt.customKeys&&delete this.Bt.customKeys;const e=[...Me,...this.Bt.customKeys||[]],n=[...Pe,...this.Bt.customKeys||[]];this.Yt=new me(t.Qt||Ve,e),this.Kt=new be(n),this.Jt=new xe}async j(){if(!this.Bt.enabled)return{};try{const t={};await this.Ht();const e=await this.Yt.gt();Object.assign(t,e);const n=await this.Kt.bt();Object.assign(t,n);const r=function(){const t={},e=function(){try{const t=i();return t?{[ae]:t}:{}}catch(t){return{}}}();Object.assign(t,e);const n=function(){try{const t=s();return t?{[ue]:t}:{}}catch(t){return{}}}();return Object.assign(t,n),t}();Object.assign(t,r);const o=await this.Jt.qt();Object.assign(t,o);const c=this.Gt(t);return this.Bt.maintainInternalPool&&await this.Vt(c),c}catch(t){return{}}}Gt(t){const e={},n=this.Bt.maxRefIds||20;let r=0;for(const[i,s]of Object.entries(t)){if(r>=n)break;s&&(this.Bt.includeEmpty||""!==s.trim())&&(e[i]=s,r++)}return e}Xt(t){this.Bt={...this.Bt,...t};const e=[...Me,...this.Bt.customKeys||[]],n=[...Pe,...this.Bt.customKeys||[]];this.Yt=new me(t.Qt?t.Qt:this.Bt.Qt||Ve,e),this.Kt=new be(n)}async Ht(){try{if(!this.Bt.maintainInternalPool)return;const t=(this.Bt.Qt||Ve).o(Jt);this.Ft=t&&t.entries?t:{entries:{}}}catch(t){this.Ft={entries:{}}}}async Vt(t){if(!this.Ft)return;const e=Date.now();let n=!1;for(const[r,i]of Object.entries(t)){const t=this.Ft.entries[r];t&&t.value===i||(this.Ft.entries[r]={id:r,value:i,timestamp:e},n=!0)}n&&await this.Wt()}async Wt(){try{if(!this.Ft)return;(this.Bt.Qt||Ve).q(Jt,this.Ft)}catch(t){}}async Zt(){return await this.Ht(),this.Ft}async te(){try{const t=this.Bt.Qt||Ve;await t.F(Jt),this.Ft={entries:{}}}catch(t){}}ee(){return{...this.Bt}}}let Le=null,ze={};const Re=[1][0],Ne=new class{constructor(t=Re){this.ne=0,this.re=0,this.ie=0,this.J=!1,this.se=!1,this.oe="",this.ce=0,this.ae=t}ue(){this.se||(this.se=!0,this.oe=`tab_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,this.ne=Date.now(),this.re=Date.now(),this.ce=0,this.le()&&(this.he=this.fe()))}de(){return this.ue(),(Date.now()-this.ne)/1e3}ye(){return this.ue(),this.ie}C(){this.ue();const t={page_views:this.ye(),time_on_site:this.de(),start_time:this.ne,last_activity:this.re,referer_url:this.Dt(),referer_title:this.Tt()};return this.he&&(t.browser_metadata=this.he),t}async _e(){this.ue(),await this.we();try{this.ce++,this.re=Date.now();const t=c(Ve.o(Gt),0),e=Math.max(this.ce,t+1);Ve.q(Gt,e.toString()),Ve.q(Vt,this.re.toString()),this.ie=e}catch(t){this.re=Date.now(),this.ie=this.ce}}pe(){}l(t){this.ue(),this.ae=t,this.le()?this.he||(this.he=this.fe()):this.he=void 0}O(){return this.ae}ge(){this.ue(),this.ne=Date.now(),this.ie=0,this.re=Date.now(),Ve.F(Ht),Ve.F(Gt),Ve.F(Vt)}async we(){this.J||(await this.ve(),this.J=!0)}async ve(){const t=Date.now(),e=Ve.o(Vt);if(!e||t-c(e,0)>216e5)this.ne=t,this.ie=0,Ve.q(Ht,this.ne.toString()),Ve.q(Gt,this.ie.toString());else{const e=Ve.o(Ht),n=Ve.o(Gt),r=c(e,0),i=c(n,0);!e||isNaN(r)||0===r?(this.ne=t,this.ie=0,Ve.q(Ht,this.ne.toString()),Ve.q(Gt,this.ie.toString())):(this.ne=r,this.ie=isNaN(i)?0:i)}this.re=t,Ve.q(Vt,t.toString())}le(){return 1!==this.ae}Dt(){var t,e,n,r;let i="";try{"undefined"!=typeof window&&window.location&&(i=window.location.href||"")}catch(s){}try{if("undefined"!=typeof self&&"undefined"!=typeof window&&self!==window.top){const s=null==(e=null==(t=window.top)?void 0:t.location)?void 0:e.href,o=null==(r=null==(n=window.parent)?void 0:n.location)?void 0:r.href;s&&"about:blank"!==s?i=s:o&&"about:blank"!==o&&(i=o),"about:srcdoc"!==i&&"about:blank"!==i||(i="")}}catch(s){}try{return encodeURI(i)}catch(s){return i}}Tt(){var t,e,n,r;let i="";try{"undefined"!=typeof document&&document.title&&(i=document.title.trim())}catch(s){}try{if("undefined"!=typeof self&&"undefined"!=typeof window&&self!==window.top){const s=null==(e=null==(t=window.top)?void 0:t.document)?void 0:e.title,o=null==(r=null==(n=window.parent)?void 0:n.document)?void 0:r.title;s&&s.trim()?i=s.trim():o&&o.trim()&&(i=o.trim())}}catch(s){}return i}fe(){var t;const e=Date.now();return"undefined"==typeof navigator||"undefined"==typeof screen||"undefined"==typeof window?{user_agent:"",screen_width:0,screen_height:0,language:"",timezone:"",timestamp:e,color_depth:0,pixel_ratio:1,timezone_offset:0,platform:"",cookie_enabled:!1,do_not_track:"unspecified"}:{user_agent:navigator.userAgent,screen_width:screen.width,screen_height:screen.height,language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,timestamp:e,color_depth:screen.colorDepth,pixel_ratio:window.devicePixelRatio,timezone_offset:(new Date).getTimezoneOffset(),platform:(null==(t=navigator.userAgentData)?void 0:t.platform)||navigator.platform,cookie_enabled:navigator.cookieEnabled,do_not_track:navigator.doNotTrack||"unspecified"}}},qe=new class{constructor(){this.me=[],this.be=!1,this.Se=null,this.Ee=100,this.ke=3e5}$e(){const t=Date.now();this.me=this.me.filter(e=>t-e.Ie<this.ke)}_(t){this.$e(),this.me.length>=this.Ee&&this.me.splice(0,this.me.length-this.Ee+1);const e={...t,Ie:Date.now(),De:()=>{},Te:()=>{}};this.me.push(e),this.je()}je(){this.Se&&(xt(this.Se),this.Se=null),this.Se=Ot(()=>{this.Ce(),this.Se=null},3e4)}async Ce(){if(!this.be&&0!==this.me.length){for(this.be=!0,this.$e();this.me.length>0;){const e=this.me.shift();if(e)try{const t=await d(e.p,e.m,e.S,e.k,!1);e.De(t)}catch(t){const n=y(t),r=new Response(JSON.stringify({error:n.message}),{status:520,statusText:"Retry queue delivery failed",headers:{"Content-Type":"application/json"}});r.cause=n,e.De(r)}}this.be=!1}}Oe(){this.me=[],this.Se&&(xt(this.Se),this.Se=null)}xe(){return this.me.length}},Fe=["tks","jlg"];let Be=null;const Ye={$:5e3,I:3,D:1e3,h:!0},Qe="__rio";let Ke=null,Je=!1,He={};class Ge{constructor(t={}){this.Me=null,this.Bt={cookieDomain:t.cookieDomain||("undefined"==typeof window?"localhost":window.location.hostname),cookiePath:t.cookiePath||"/",cookieSecure:t.cookieSecure??"https:"===("undefined"==typeof window?"http:":window.location.protocol),cookieSameSite:t.cookieSameSite||"Lax",...t}}o(t){try{if(pe.has(t)||this.Pe(t))return function(t,e){var n,r;try{let i=null,s="local";if(e&&(i=null==(n=S().localStorage)?void 0:n.getItem(t)),i||(i=He[t],s="memory"),!i)return null;try{const n=kt(i);return n&&"number"==typeof n.expires?Date.now()>n.expires?("local"===s?null==(r=S().localStorage)?void 0:r.removeItem(t):delete He[t],null):(E(t,n.value,e),n.value):n}catch{return null}}catch(i){return null}}(t,this.Ae());const e=this.Ue(t);if(!e)return null;if(ge.has(t))try{return kt(e)}catch{return e}try{return kt(e)}catch{return e}}catch(e){return p(`storage_get_failed: ${e instanceof Error?e.message:String(e)}`,"storage-manager"),null}}q(t,e){try{if(pe.has(t)||this.Pe(t))return E(t,e,this.Ae());const n=ge.has(t)?String(e):$t(e);return this.Le(t,n)}catch(n){return p(`storage_set_failed: ${n instanceof Error?n.message:String(n)}`,"storage-manager"),!1}}F(t){try{return pe.has(t)||this.Pe(t)?function(t,e){var n;let r=!1;return e&&(null==(n=S().localStorage)?void 0:n.removeItem(t),r=!0),t in He&&(delete He[t],r=!0),r}(t,this.Ae()):this.ze(t)}catch(e){return p(`storage_remove_failed: ${e instanceof Error?e.message:String(e)}`,"storage-manager"),!1}}B(t){try{return t.map(t=>this.o(t))}catch(e){return p(`storage_get_failed: ${e instanceof Error?e.message:String(e)}`,"storage-manager"),t.map(()=>null)}}Re(t,e){try{const n=g("string"==typeof e?e:$t(e));return this.Le(t,n)}catch(n){return p(`storage_set_failed: ${n instanceof Error?n.message:String(n)}`,"storage-manager"),!1}}Ne(t){try{const e=this.Ue(t);if(!e)return null;const n=v(e);if(!n)return null;try{return kt(n)}catch{return n}}catch(e){return p(`storage_get_failed: ${e instanceof Error?e.message:String(e)}`,"storage-manager"),null}}u(t){return b(t)}Y(){return function(t){try{const e=[];if(t){const t=S().localStorage;if(t){const n=t.length;for(let r=0;r<n;r++){const n=t.key(r);n&&e.push(n)}}}const n=Object.keys(He);for(const t of n)e.includes(t)||e.push(t);return e}catch{return[]}}(this.Ae())}qe(t){return t.startsWith("_oir_")&&(t.endsWith("_lk")||t.endsWith("_dt"))}Pe(t){return t.startsWith(he)||t.startsWith(fe)||t.startsWith(de)}Ue(t){var e;try{return _e.has(t)||we.has(t)?b(t):(ye.has(t)||this.qe(t))&&this.Ae()?(null==(e=S().localStorage)?void 0:e.getItem(t))??null:null}catch(n){return p(`storage_get_failed: ${n instanceof Error?n.message:String(n)}`,"storage-manager"),null}}Le(t,e){var n;try{return _e.has(t)?function(t,e,n,r=!1){try{if("undefined"==typeof document)return!1;let s=`${t}=${i=e,encodeURIComponent(i)}`;if(n.cookieDomain&&(s+=`; domain=${n.cookieDomain}`),n.cookiePath&&(s+=`; path=${n.cookiePath}`),n.cookieSecure&&(s+="; secure"),n.cookieSameSite&&(s+=`; SameSite=${n.cookieSameSite}`,"None"!==n.cookieSameSite||n.cookieSecure||(s+="; secure")),!r){const t=new Date;t.setFullYear(t.getFullYear()+1),s+=`; expires=${t.toUTCString()}`}return Ct(s),Ke=null,!0}catch(s){return!1}var i}(t,e,this.Bt):!(we.has(t)||!ye.has(t)&&!this.qe(t)||!this.Ae()||(null==(n=S().localStorage)?void 0:n.setItem(t,e),0))}catch(r){return p(`storage_set_failed: ${r instanceof Error?r.message:String(r)}`,"storage-manager"),!1}}ze(t){var e;try{return _e.has(t)?function(t,e){try{if("undefined"==typeof document)return!1;let n=`${t}=; expires=Thu, 01 Jan 1970 00:00:00 GMT`;return e.cookieDomain&&(n+=`; domain=${e.cookieDomain}`),e.cookiePath&&(n+=`; path=${e.cookiePath}`),Ct(n),Ke=null,!0}catch(n){return!1}}(t,this.Bt):!(we.has(t)||(ye.has(t)||this.qe(t))&&(this.Ae()&&(null==(e=S().localStorage)?void 0:e.removeItem(t)),0))}catch(n){return p(`storage_remove_failed: ${n instanceof Error?n.message:String(n)}`,"storage-manager"),!1}}Ae(){var t,e,n,r;if(null!==this.Me)return this.Me;try{if("undefined"!=typeof globalThis&&void 0!==globalThis.process&&"test"===(null==(e=null==(t=globalThis.process)?void 0:t.env)?void 0:e.NODE_ENV))return this.Me=void 0!==S().localStorage,this.Me;if("undefined"==typeof window||void 0===S().localStorage)return this.Me=!1,!1;const i="__oir_test";return null==(n=S().localStorage)?void 0:n.setItem(i,"test"),null==(r=S().localStorage)||r.removeItem(i),this.Me=!0,!0}catch{return this.Me=!1,!1}}}const Ve=new Ge,Xe=Object.freeze(Object.defineProperty({__proto__:null,Fe:Ge,Qt:Ve},Symbol.toStringTag,{value:"Module"})),We=Math.random().toString(36).substring(2,11),Ze=18e4;class tn{constructor(t){if(this.Be=null,this.Ye=null,this.Qe=null,this.Bt=t,this.Ke=t.lockKey||`${t.taskId}_lk`,this.Je=t.dataKey||`${t.taskId}_dt`,this.He=function(){try{return"undefined"!=typeof BroadcastChannel}catch{return!1}}(),this.He)try{this.Be=new BroadcastChannel(`_oir_${t.taskId}`)}catch{this.He=!1}this.Be&&(this.Qe=()=>this.Ge(),Dt("beforeunload",this.Qe))}async P(){try{const t=Ve.Ne(this.Ke);return!!t&&(this.Ve(t)?(this.Xe(),!1):t.tabId!==We)}catch(t){return!1}}async A(){try{const t=Ve.Ne(this.Ke);if(t&&!this.Ve(t))return!1;t&&this.Xe();const e=Date.now();Ve.Re(this.Ke,{tabId:We,timestamp:e,status:"pending"});const n=Math.floor(91*Math.random())+10;await a(n,wt);const r=Ve.Ne(this.Ke);if(!r)return!1;const i=r.tabId===We,s=Math.abs(r.timestamp-e)<=10;return i&&s}catch(t){return!1}}L(){this.Xe()}async R(){return new Promise(t=>{let e=!1;const n=n=>{e||(e=!0,o(),t(n))},r=setTimeout(()=>{n({success:!1,error:"Wait timeout",timestamp:Date.now(),acquiredLock:!1,processedByTabId:We})},this.Bt.timeout);let i=null;this.Be&&(i=t=>{const e=t.data;e.taskId===this.Bt.taskId&&"done"===e.type&&n({success:!0,data:e.data,timestamp:e.timestamp,acquiredLock:!1,processedByTabId:e.tabId})},this.Be.addEventListener("message",i));const s=t=>{if(t.key===this.Je&&t.newValue){const t=this.We();null!==t&&n({success:!0,data:t,timestamp:Date.now(),acquiredLock:!1,processedByTabId:We})}};Dt("storage",s);const o=()=>{clearTimeout(r),i&&this.Be&&this.Be.removeEventListener("message",i),Tt("storage",s)}})}async N(t){try{Ve.Re(this.Je,{data:t,timestamp:Date.now()}),this.Ze("done",t)}catch(e){}}async tn(){try{const t=Ve.Ne(this.Je);return t?Date.now()-t.timestamp>Ze?(Ve.F(this.Je),this.en(),null):t.data:(this.en(),null)}catch(t){return null}}async U(){try{const t=Ve.Ne(this.Ke),e={tabId:We,timestamp:(null==t?void 0:t.timestamp)||Date.now(),status:"completed"};Ve.Re(this.Ke,e)}catch(t){}}async nn(t,e){try{if(await this.P())return await this.R();if(!(null==e?void 0:e.skipMemoization)){const t=await this.tn();if(t)return{success:!0,data:t,timestamp:Date.now(),acquiredLock:!1,processedByTabId:We}}if(!(await this.A()))return await this.R();try{const n=await t();return(null==e?void 0:e.skipStoringResult)?this.Ze("done",n):(await this.N(n),await this.U()),{success:!0,data:n,timestamp:Date.now(),acquiredLock:!0,processedByTabId:We}}finally{this.L()}}catch(n){return{success:!1,error:n instanceof Error?n.message:"Unknown error",timestamp:Date.now(),acquiredLock:!1,processedByTabId:We}}}rn(){this.en()}Ge(){if(this.Qe&&(Tt("beforeunload",this.Qe),this.Qe=null),this.Ye&&(Tt("storage",this.Ye),this.Ye=null),this.Be){try{this.Be.close()}catch{}this.Be=null}}Ve(t){return Date.now()-t.timestamp>this.Bt.timeout}Xe(){try{Ve.F(this.Ke)}catch(t){}}Ze(t,e){if(this.Be)try{const n={type:t,taskId:this.Bt.taskId,tabId:We,data:e,timestamp:Date.now()};this.Be.postMessage(n)}catch{}}We(){try{const t=Ve.Ne(this.Je);return t?Date.now()-t.timestamp>Ze?null:t.data:null}catch{return null}}en(){try{const t=Date.now(),e=Ve.Ne(this.Ke);e&&t-e.timestamp>Ze&&Ve.F(this.Ke);const n=Ve.Ne(this.Je);n&&t-n.timestamp>Ze&&Ve.F(this.Je)}catch(t){}}}let en=null,nn=[];const rn={taskId:"_oir_init",timeout:3e4};let sn=null;const on=100;let cn=[],an=null,un=!1,ln=!1;const hn=Object.freeze(Object.defineProperty({__proto__:null,sn:L,cn:function(){null!==an&&(xt(an),an=null),P()},an:U,un:A},Symbol.toStringTag,{value:"Module"})),fn=new class{constructor(t={}){this.ln={},this.hn={},this.ot=(t,e)=>{try{this.ln[t]||(this.ln[t]=[]),this.ln[t].push(e),this.Bt.enableListenerTracking&&N(t,this.ln[t].length),this.hn[t]&&e(this.hn[t])}catch(n){p(`cache_set_listener_count_failed: ${n instanceof Error?n.message:String(n)}`,"event-manager")}},this.ct=(t,e)=>{try{if(!this.ln[t])return;this.ln[t]=this.ln[t].filter(t=>t!==e),this.Bt.enableListenerTracking&&N(t,this.ln[t].length)}catch(n){p(`cache_set_listener_count_failed: ${n instanceof Error?n.message:String(n)}`,"event-manager")}},this.fn=(t,e)=>{try{const n=`${he}${t}`;if(R(n))return;!function(t){try{return Ve.q(t,"true")}catch(e){return!1}}(n),this.hn[t]=e,this.Bt.enableHistory&&function(t,e){try{return Ve.q(`${fe}${t}`,e)}catch(n){return!1}}(t,e),this.ln[t]&&this.ln[t].forEach(t=>{try{t(e)}catch(n){p(`cache_set_event_history_failed: ${n instanceof Error?n.message:String(n)}`,"event-manager")}})}catch(n){p(`cache_set_event_history_failed: ${n instanceof Error?n.message:String(n)}`,"event-manager")}},this.dn=t=>{try{return R(`${he}${t}`)}catch(e){return p(`cache_get_dom_event_failed: ${e instanceof Error?e.message:String(e)}`,"event-manager"),!1}},this.yn=t=>{try{if(this.hn[t])return this.hn[t];if(this.Bt.enableHistory){const e=function(t){try{return Ve.o(`${fe}${t}`)}catch(e){return null}}(t);if(e)return this.hn[t]=e,e}return null}catch(e){return p(`cache_get_event_history_failed: ${e instanceof Error?e.message:String(e)}`,"event-manager"),null}},this._n=t=>{try{delete this.hn[t],this.Bt.enableHistory&&function(t){try{return Ve.F(`${fe}${t}`)}catch(e){return!1}}(t)}catch(e){p(`cache_clear_event_history_failed: ${e instanceof Error?e.message:String(e)}`,"event-manager")}},this.wn=t=>{try{return this.ln[t]?this.ln[t].length:this.Bt.enableListenerTracking?function(t){try{return Ve.o(`${de}${t}`)||0}catch(e){return 0}}(t):0}catch(e){return p(`cache_get_listener_count_failed: ${e instanceof Error?e.message:String(e)}`,"event-manager"),0}},this.pn=()=>{try{Object.keys(this.ln).forEach(t=>{this.ln[t]=[],this.Bt.enableListenerTracking&&N(t,0)}),Object.keys(this.hn).forEach(t=>{delete this.hn[t]}),this.Bt.enableHistory&&q()}catch(t){p(`cache_clear_event_history_failed: ${t instanceof Error?t.message:String(t)}`,"event-manager")}},this.Bt={enableHistory:!0,enableListenerTracking:!0,maxHistoryEntries:100,historyTTL:864e5,...t}}},dn=class t{constructor(){this.gn=!1,this.vn=0}static getInstance(){return t.mn||(t.mn=new t),t.mn}async st(t){if(!this.gn){this.gn=!0;try{if(this.bn())return;const e=await this.Sn();this.En(e)&&await this.kn(e,t)}catch(e){p(`echo_id_execution_failed: ${e instanceof Error?e.message:String(e)}`,"echo-id")}finally{this.gn=!1}}}async Sn(){const t={};if(!Ve.o(ne)){const e=Ve.o(te);e&&(t.osxid=e)}const e=Ve.o(re),n=Ve.o(ee);return!e&&n&&(t.osxcid=n),t}En(t){return Object.keys(t).length>0}async kn(t,e){this.$n(t);try{const n={};t.osxid&&(n["X-Reference-osxid"]=t.osxid),t.osxcid&&(n["X-Reference-osxcid"]=t.osxcid),await f(e,{method:"GET",headers:n,timeout:5e3,credentials:"include"})}catch(n){p(`echo_id_recovery_error: ${n instanceof Error?n.message:String(n)}`,"echo-id")}}$n(t){try{const e=new CustomEvent("onEchoIdMissing",{detail:{...t,timestamp:Date.now()}});fn.fn("onEchoIdMissing",e)}catch(e){p(`echo_id_event_failed: ${e instanceof Error?e.message:String(e)}`,"echo-id")}}bn(){const t=Date.now();return t-this.vn<5e3||(this.vn=t,!1)}};dn.mn=null;const yn=dn.getInstance(),_n={taskId:"_oir_event_cache",timeout:3e4};let wn;const pn={[pt]:(r,i,s)=>{!function(r,i){let s={};if("string"==typeof r&&void 0!==i)s[r]=i;else{if("object"!=typeof r||null===r)return;s=r}t()?n(s):e(s),function(t){if("echoUrl"in t){const e=t.echoUrl;e&&"string"==typeof e&&yn.st(e).catch(t=>{p(`echo_id_trigger_failed: ${t instanceof Error?t.message:String(t)}`,"command-handlers")})}}(s)}(i,s)},[St]:(t,e,n)=>{fn.ot(e,n)},[Et]:(t,e,n)=>{fn.ct(e,n)},[mt]:(t,e,n)=>{!function(t,e,n){try{try{q()}catch(r){p(`cache_clear_event_history_failed: ${r instanceof Error?r.message:String(r)}`,"command-handlers")}if(!t)return;if(!e||"object"!=typeof e||Array.isArray(e))return;const i=B(e);if(!i||"object"!=typeof i||Array.isArray(i))return;Y(t,i,n).catch(()=>{})}catch(r){p(`debug_invalid_oirtyp: ${r instanceof Error?r.message:String(r)}`,"command-handlers")}}(t.J,e,n)}};class gn{constructor(){this.me=[],this.J=!1,this.be=!1,this.In()}In(){if("undefined"!=typeof window)if(window._oirtrk||(window._oirtrk=[]),It(window._oirtrk))this.me=window._oirtrk;else{const t=window._oirtrk;t&&It(t.Dn)&&(this.me=t.Dn,delete t.Dn)}}W(){return this.me}async tt(){this.J=!0,this.Tn(),this.jn()}Tn(){if(0===this.me.length)return;const t=[],e=[];for(const n of this.me){if(!It(n)||n.length<2){t.push(n);continue}const r=V(n);G(r)?e.push(r):t.push(r)}this.me=t;for(const n of e)It(n)&&J(n)}jn(){this.Cn(),nn.push(()=>{this.Cn()})}async Cn(){if(!this.be)if(D()){this.X(),this.be=!0;try{await async function(t){if(D())try{await(wn??(wn=k(_n))).nn(async()=>await async function(t){let e;try{e=U()}catch(o){return{sent:0,failed:0}}if(!e||0===e.events.length)return{sent:0,failed:0};let n=0,r=0;const i=[],s=[];for(const a of e.events)try{if(!It(a.actionArray)||a.actionArray.length<2)continue;(await H(t,a.actionArray)).success?(n++,i.push(a)):(r++,s.push(a))}catch(o){r++,s.push(a)}try{const{cn:t}=await Promise.resolve().then(()=>hn);t();const e=await Promise.resolve().then(()=>Xe),n=e.Qt.o(Zt)||[],r=new Set;for(const s of i)r.add(s.id);const o=n.filter(t=>!r.has(t.id)),c=new Set(o.map(t=>t.id)),a=[...o];for(const i of s)c.has(i.id)||a.push(i);const u=a.sort((t,e)=>new Date(t.time).getTime()-new Date(e.time).getTime());u.length>0?e.Qt.q(Zt,u):await e.Qt.F(Zt)}catch(o){if(s.length>0){const{un:t}=await Promise.resolve().then(()=>hn);for(const e of s)try{t(e)}catch(c){}}}return{sent:n,failed:r}}(t),{skipMemoization:!0,skipStoringResult:!0})}catch(e){}}(this.J),await this.On()}catch(t){p(`queue_cache_send_error: ${t instanceof Error?t.message:String(t)}`,"queue")}finally{this.be=!1}}else this.me.length>0&&this.xn()}xn(){const t=[];for(const e of this.me)if(It(e)&&e.length>=2){const[n]=e;n!==vt&&n!==mt||t.push(e)}t.length>0&&(this.me=this.me.filter(e=>!t.includes(e)))}async On(){if(!D())return this.xn(),void 0;const t=[...this.me];this.me.length=0;for(const e of t)It(e)&&e.length>=2&&this.Mn(e)}ut(t){const e=V(t);if(this.J&&D())return this.Mn(e),void 0;G(e)?J(e):this.me.push(e)}Mn(t){!It(t)||t.length<2||X({J:this.J},t)}Pn(){this.me.length=0}X(){if(0===this.me.length)return;const t=["cfg",gt];this.me=this.me.filter(e=>{if(!It(e)||e.length<2)return!0;const[n]=e;return!t.includes(n)||(X({J:this.J},e),!1)})}}const vn={$:1e4,An:!0,I:3,D:1e3},mn=class t{constructor(t=vn){this.Un=!1,this.Bt={...vn,...t}}static V(e){return t.mn||(t.mn=new t(e)),t.mn}async G(e=!1){if(!e){const t=await this.Ln();if(t)return{H:t,zn:!0,Rn:{},Ie:Date.now(),Nn:0}}if(t.qn)return t.qn;const n=this.Fn();t.qn=n;try{return await n}finally{t.qn=null}}async Fn(){const t=Date.now();this.Un=!0;try{let n={};try{n=await u().j()}catch(e){p(`error: ${e instanceof Error?e.message:String(e)}`,"user-id-manager"),n={}}const r=`https://${Nn.getInstance().Bn()}/echo`,i=await this.Yn(r,n),s={H:i,zn:!1,Rn:n,Ie:Date.now(),Nn:Date.now()-t};return await this.Qn(i),s}catch(e){throw p(`userid_generation_failed: ${e instanceof Error?e.message:String(e)}`,"user-id-manager"),e}finally{this.Un=!1}}async Yn(t,e){return _(async()=>{const n=await this.Kn(t,e);if(n.ok)return await this.Jn(n);throw new Error(`HTTP ${n.status}: ${n.statusText}`)},this.Bt.I,this.Bt.D,this.Bt.An)}async Kn(t,e){const n={Accept:"application/json",...this.Bt.Hn};for(const[r,i]of Object.entries(e))n[`X-Reference-${r}`]=i;return Object.keys(e).length>0&&(n["X-Reference-Count"]=Object.keys(e).length.toString()),f(t,{method:"GET",headers:n,credentials:"include",timeout:this.Bt.$})}async Jn(t){try{const e=await t.json();if(e.echo)return e.echo;throw new Error("User ID not found in response")}catch(e){if(p(`userid_extract_failed: ${e instanceof Error?e.message:String(e)}`,"user-id-manager"),e instanceof Error&&e.message.includes("User ID not found in response"))throw e;throw new Error("Invalid response format")}}async Ln(){try{return z()}catch(t){return p(`userid_cache_get_failed: ${t instanceof Error?t.message:String(t)}`,"user-id-manager"),null}}async Qn(t){try{!function(t){try{Ve.q(Bt,t),Ve.q(te,t)}catch(e){}}(t),I(t),await x(t)}catch(e){p(`userid_cache_failed: ${e instanceof Error?e.message:String(e)}`,"user-id-manager")}}async getCurrentUserId(){return D()||await this.Ln()}clearCachedUserId(){try{!function(){try{Ve.q(Bt,""),Ve.q(te,"")}catch(t){}}(),T()}catch(t){p(`userid_cache_clear_failed: ${t instanceof Error?t.message:String(t)}`,"user-id-manager")}}updateConfig(t){this.Bt={...this.Bt,...t}}getConfig(){return{...this.Bt}}isGeneratingUserId(){return this.Un}static resetInstance(){t.mn=null,t.qn=null}};mn.mn=null,mn.qn=null;let bn=mn;const Sn={iframe:{height:"1px",width:"1px",frameborder:"0",scrolling:"no",style:"display:none;visibility:hidden;"},img:{height:"1px",width:"1px",border:"0",style:"display: none;"},script:{type:"text/javascript"}},En={enableLogging:!0,enableCleanup:!0,insertionStrategy:["append"][0]},kn=new class{constructor(t={}){this.Gn=new Set,this.Vn=new Set,this.Xn=new Map,this.Wn=!1,this.Zn=(t,e)=>{this.Wn||(this.Wn=!0,this.tr());try{const n=function(t){try{return"image"===t?"img":"img"===t||"iframe"===t||"script"===t?t:null}catch{return null}}(String(t.tag));if(null===n)return{success:!1,error:`Element type '${t.tag}' is not supported`,type:t.tag};const r={...t,tag:n};if(r.text&&this.Vn.has(r.text))return{success:!1,error:`Element '${r.text}' has been loaded already`,type:r.tag};const i=function(t){try{if(!function(t){try{return!!(t&&"object"==typeof t&&t.tag&&"string"==typeof t.tag&&["iframe","img","script"].includes(t.tag)&&t.attrs&&"object"==typeof t.attrs)}catch(e){return p(`pixel_element_validation_failed: ${e instanceof Error?e.message:String(e)}`,"element-utils"),!1}}(t))return{success:!1,error:"Invalid element information",type:t.tag};if("undefined"==typeof document)return{success:!1,error:"DOM not available",type:t.tag};const n=(t=>{if("undefined"==typeof document)throw new Error("Document not available");return document.createElement(t)})(t.tag),r={...Sn[t.tag]||{},...t.attrs};for(const[t,i]of Object.entries(r))try{"boolean"==typeof i?i&&n.setAttribute(t,""):n.setAttribute(t,i)}catch(e){p(`pixel_element_attribute_set_failed: ${e instanceof Error?e.message:String(e)}`,"element-utils")}return t.text&&"script"===t.tag&&(n.text=t.text),{success:!0,element:n,type:t.tag}}catch(n){return p(`pixel_element_creation_failed: ${n instanceof Error?n.message:String(n)}`,"element-utils"),{success:!1,error:n instanceof Error?n.message:"Unknown error",type:t.tag}}}(r);if(!i.success||!i.element)return i;const s=i.element;if(!this.er(s,e))return{success:!1,error:"Failed to insert element into DOM",type:r.tag};if(this.Gn.size>=500){const t=this.Gn.values().next().value;t&&this.Gn.delete(t)}return this.Gn.add(s),this.Xn.set(r.tag,s),r.text&&this.Vn.add(r.text),i}catch(n){return{success:!1,error:n instanceof Error?n.message:"Unknown error",type:t.tag}}},this.nr=t=>{try{const e=Z(t);if(e){if(this.Gn.delete(t),"script"===t.tagName.toLowerCase()){const e=t.text;e&&this.Vn.has(e)&&this.Vn.delete(e)}for(const[e,n]of this.Xn.entries())if(n===t){this.Xn.delete(e);break}}return e}catch(e){return!1}},this.rr=t=>{try{return Array.from(this.Gn).filter(e=>e.tagName.toLowerCase()===t)}catch(e){return[]}},this.ir=()=>{try{return new Map(this.Xn)}catch(t){return new Map}},this.sr=()=>{try{let t=!0;for(const e of this.Gn)if(Z(e)||(t=!1),"script"===e.tagName.toLowerCase()){const t=e.text;t&&this.Vn.has(t)&&this.Vn.delete(t)}return this.Gn.clear(),this.Xn.clear(),this.Vn.clear(),t}catch(t){return!1}},this.ee=()=>{try{return{...this.Bt}}catch(t){return En}},this.er=(t,e)=>{try{const n=this.Bt.insertionStrategy||"append";if(e)return W(t,e);switch(n){case"prepend":return W(t,{position:"prepend"});case"insertBefore":return this.cr(t);default:return W(t,{position:"append"})}}catch(n){return!1}},this.cr=t=>{try{const e=(()=>{if("undefined"==typeof document)throw new Error("Document not available");return Array.from(document.getElementsByTagName("script"))})()[0];return e&&e.parentNode?(e.parentNode.insertBefore(t,e),!0):W(t,{position:"append"})}catch(e){return!1}},this.tr=()=>{try{if(!this.Bt.enableCleanup||"undefined"==typeof window)return;const t=()=>{this.sr()};Dt("beforeunload",t),Dt("unload",t)}catch(t){}},this.Bt={...En,...t}}},$n=class t{constructor(){this.Bt=null,this.J=!1}static V(){return t.mn||(t.mn=new t),t.mn}ar(t){this.Bt=t,this.J=!0}ur(){return this.J&&null!==this.Bt}ee(){return this.Bt}lr(){return this.Bt||null}hr(t){var e;return(null==(e=this.Bt)?void 0:e[t])||null}dr(){var t,e;return(null==(e=null==(t=this.Bt)?void 0:t.filters)?void 0:e.tos)||null}ge(){this.Bt=null,this.J=!1}};$n.mn=null;const In=$n.V(),Dn={taskId:"_oir_csc",timeout:3e4};let Tn;const jn=new class{constructor(){this.yr=null}async Z(){var t;if(this.yr)return this.yr;const e=await tt().tn();return e?(e.cfg&&In.ar(e.cfg),void 0!==(null==(t=null==e?void 0:e.cfg)?void 0:t.trackLvl)&&this._r(e),e):(this.yr=tt().nn(async()=>await this.wr()).then(t=>t.success&&t.data?t.data:null),this.yr)}async wr(){var t;try{const e={},n=await w("csc",e,{timeout:3e4});if(!n.success)return null;const r=m(n.response||"{}",!1);if(!r)return null;if(this.pr(r),void 0!==(null==(t=null==r?void 0:r.cfg)?void 0:t.trackLvl)&&this._r(r),r.cb&&r.cb.set){const t=r.cb.set;for(const e of Object.values(t))kn.Zn(e)}return r}catch(e){return null}}pr(t){try{(function(t){try{return!!t&&Object.keys(t).length>0}catch(e){return!1}})(t.cfg)&&In.ar(t.cfg)}catch(e){}}_r(t){var e;try{const r=null==(e=t.cfg)?void 0:e.trackLvl;"number"==typeof r&&r>=1&&r<=3&&(n({trackingLevel:r}),h(r))}catch(r){}}},Cn="onIdentify",On={taskId:"_oir_ack",timeout:3e4};let xn;class Mn{constructor(){this.J=!1,this.gr=null,this.vr=null,this.mr=async t=>{try{if(!this.J)return;if(this.gr)return;this.gr=et().nn(async()=>await this.br(t)).then(t=>t.success&&t.data?t.data:t),await this.gr}catch(e){}finally{this.gr=null}}}tt(){this.J||(this.J=!0)}nt(t){this.J&&(this.vr&&xt(this.vr),this.vr=Ot(()=>{this.mr(t)},1e4))}async br(t){try{const n=t||{};await this.Sr(n);const r=await this.Er(n);if(r){if(await this.kr(r),r.csync)try{const{rt:t}=await Promise.resolve().then(()=>Zn);t.$r(r)}catch(e){}this.Ir(r)}return r}catch(e){return null}}async Sr(t){try{const{rt:e}=await Promise.resolve().then(()=>Zn);await e.Dr()&&(t.csync=!0)}catch(e){}}async Er(t){var e;try{if(!D())return null;const n=await w("ack",t,{timeout:3e4,retries:3,retryInterval:1e3,keepalive:!1});if(!n.success)return null;const r=await m(n.response||"{}",!1);if(!r)return null;if(null==(e=r.cb)?void 0:e.set){const t=r.cb.set;for(const e of Object.values(t))kn.Zn(e)}return r}catch(n){return null}}Ir(t){var e;try{const n=(null==(e=t.cs)?void 0:e[Yt])||"anonymous",r=new CustomEvent(Cn,{detail:{idToken:n,timestamp:Date.now()}});fn.fn(Cn,r)}catch(n){}}async kr(t){try{await et().N(t)}catch(e){}}Ge(){this.vr&&(xt(this.vr),this.vr=null),this.gr=null}}let Pn=null;const An={taskId:"_oir_ost",timeout:3e4};let Un;const Ln=new class{constructor(){this.J=!1,this.Tr=0,this.jr=15,this.Cr=null,this.Or=Xt,this.Mr=Wt}async tt(){this.J||(this.J=!0,await this.Pr(),this.Ar(),await this.Ur())}async Pr(){try{const t=Ve.Ne(this.Or);if(t){const e=c(t,0),n=Date.now(),r=864e5;if(isNaN(e)||n-e>r){const t=n.toString();Ve.Re(this.Or,t),Ve.F(this.Mr)}}else{const t=Date.now().toString();Ve.Re(this.Or,t),Ve.F(this.Mr)}}catch(t){}}async Ur(){try{const t=Ve.Ne(this.Mr);if(null==t?void 0:t.completed){const e=Date.now();if(t.timestamp&&e-t.timestamp<=864e5)return;Ve.F(this.Mr)}const e=Ve.Ne(this.Or);if(!e)return;const n=c(e,0);if(isNaN(n))return;const r=Date.now();if(r-n>864e5)return;const i=Math.max(0,1e3*this.jr-(r-n));this.Cr=Ot(()=>{this.Lr()},i)}catch(t){}}async Lr(){try{await nt().nn(async()=>await this.zr({}))}catch(t){}}async et(t){try{await this.Rr(),await this.Nr();const e=Math.max(0,this.jr-0),n=2e3*Math.random();e>0?await a(1e3*e+n,wt):await a(n,wt);const r=await nt().nn(async()=>await this.zr(t));return r.success&&r.data?r.data:null}catch(e){return null}}async zr(t){try{this.Tr=Date.now();const e=r(),n={tos_filter:this.jr,...e,...t??{}},i=await w("ost",n,{timeout:3e4});if(!i.success)return null;Ve.Re(this.Mr,{completed:!0,timestamp:Date.now()});const s=m(i.response||"{}",!1);if(s&&s.cb&&s.cb.set){const t=s.cb.set;for(const e of Object.values(t))kn.Zn(e)}return n}catch(e){return null}}Ar(){try{const t=In.dr();if(t){const e="number"==typeof t?t:c(t,0);!isNaN(e)&&e>0&&(this.jr=e)}}catch(t){}}async Nr(){try{const t=Ve.Ne(this.Mr);if(null==t?void 0:t.completed){const e=Date.now();if(t.timestamp&&e-t.timestamp<=864e5)return;Ve.F(this.Mr)}const e=Ve.Ne(this.Or);if(!e)return;const n=c(e,0);if(isNaN(n))return;const r=Date.now();if(r-n>864e5)return;const i=Math.max(0,1e3*this.jr-(r-n));null!==this.Cr&&(xt(this.Cr),this.Cr=null),i>0&&(this.Cr=Ot(()=>{this.Lr()},i))}catch(t){}}async Rr(){try{const t=In.dr();if(t){const e="string"==typeof t?c(t,0):t;!isNaN(e)&&e>0&&(this.jr=e)}}catch(t){}}qr(){return this.Tr>0}Fr(){return this.jr}Ge(){this.Cr&&(xt(this.Cr),this.Cr=null)}};let zn=!1;const Rn=class t{constructor(){this.Bt=null,this.J=!1,this.me=new gn}static getInstance(){return t.mn||(t.mn=new t),t.mn}async tt(t){if(!t||!t.oirid||!t.oirtyp)return;if(!Object.values(yt).includes(t.oirtyp))return;const e={timeout:1e4,retry:{maxAttempts:3,backoffMs:1e3},...t};this.Bt=e;try{!function(){try{Be=new Ue({enabled:!0,includeEmpty:!1,maxRefIds:20,maintainInternalPool:!0})}catch(t){}}(),void(zn||(zn=!0,(async()=>{try{const t=await u().j();t&&Object.keys(t).length>0&&void async function(){try{const t={};await w("tks",t,{timeout:5e3,retries:2,retryInterval:1e3,keepalive:!1})}catch(t){}}().catch(()=>{})}catch(t){}})())),await async function(){await Ne._e()}(),await C(!0),await this.me.tt(),async function(){(async function(){for(;;){try{if(await j())try{const t=await O();if(t)return I(t),Ut.M(Lt,{userId:`${t.substring(0,8)}...`}),await it(),await st(),await C(!1),void 0}catch(t){p(`init_another_tab_failed: ${t instanceof Error?t.message:String(t)}`,"initialization")}const e=z();if(e)return I(e),await x(e),Ut.M("User ID found in cache",{userId:`${e.substring(0,8)}...`}),await it(),await st(),await C(!1),void 0;try{const t=await rt();return Ut.ht("User ID initialization successful",{userId:`${t.substring(0,8)}...`}),await it(),await st(),await C(!1),void 0}catch(t){p(`init_userid_failed: ${t instanceof Error?t.message:String(t)}`,"initialization"),await C(!1)}}catch(t){p(`init_userid_failed: ${t instanceof Error?t.message:String(t)}`,"initialization"),await C(!1)}const e=3e4;await new Promise(t=>{Ot(()=>t(),e)})}})().catch(t=>{p(`init_userid_failed: ${t instanceof Error?t.message:String(t)}`,"initialization")})}().catch(t=>{p(`sdk_background_user_id_failed: ${t instanceof Error?t.message:String(t)}`,"sdk")}),this.J=!0}catch(n){this.J=!1,this.Bt=null,await C(!1),p(`init_sdk_failed: ${n instanceof Error?n.message:String(n)}`,"sdk")}!function(){try{if(!1===r().autoPageView)return;const t=Nn.getInstance();if(!t.Br())return;const e=["event",{event:"page_view",payload:ot()}];t.W().ut(e)}catch(n){}}()}Bn(){return this.J&&this.Bt&&this.Bt.brandedLinkDomain||"oirt.aggle.net"}W(){return this.me}Oe(){this.me.Pn()}Br(){return this.J}ee(){return this.Bt}ge(){this.Bt=null,this.J=!1,this.me.Pn()}};Rn.mn=null;let Nn=Rn,qn=null;const Fn="251015",Bn=[],Yn=[],Qn={cfg:async r=>{t()?n(r):e(r),function(t){if(t&&"object"==typeof t){if("echoUrl"in t){const e=t.echoUrl;if(e&&"string"==typeof e){const t=at();(null==t?void 0:t.Br())&&yn.st(e).catch(()=>{})}}if("trackingLevel"in t){const e=t.trackingLevel;"number"==typeof e&&e>=1&&e<=3&&h(e)}}}(r),await ft();const i=at();(null==i?void 0:i.Br())&&(ht(),lt())},push:t=>{const e=at();(null==e?void 0:e.Br())?ut(t):Bn.push(t)},destroy:()=>{const t=at();Bn.length=0,Yn.length=0,(null==t?void 0:t.Br())&&t.ge(),qt={...Nt},Ft=!1,T(),L(),fn.pn()},version:()=>ct(),addEventListener:(t,e)=>{const n=at();(null==n?void 0:n.Br())?fn.ot(t,e):Yn.push({type:t,listener:e})},removeEventListener:(t,e)=>{const n=Yn.findIndex(n=>n.type===t&&n.listener===e);if(-1!==n)return Yn.splice(n,1),void 0;fn.ct(t,e)}};"undefined"!=typeof window&&!function(){if("undefined"!=typeof window){const t=It(window[dt])?window[dt]:[];window[dt]=Qn,t.length>0&&(Qn.Dn=t)}else if("undefined"!=typeof globalThis){const t=globalThis,e=It(t[dt])?t[dt]:[];globalThis[dt]=Qn,e.length>0&&(Qn.Dn=e)}(async function(){try{const t=(null===qn&&function(){if("undefined"!=typeof window)try{const t="undefined"==typeof document?null:document.currentScript;if(t){const e=t.getAttribute("oirid"),n=t.getAttribute("oirtyp");if(e&&n){const t=Object.values(yt);qn=t.includes(n)?{oirid:e,oirtyp:n}:{oirid:e,oirtyp:yt.lt}}}}catch(t){}}(),qn);t&&e(t),await ft();const n=at();(null==n?void 0:n.Br())&&(ht(),lt())}catch(t){}})().catch(()=>{})}();const Kn="k7a2",Jn="y9t1",Hn="s3n8",Gn="b6m4";class Vn{constructor(){this.Yr=!1,this.Qr=new Set,this.Kr=new Map}Jr(t,e){this.Kr.set(t,e)}async it(t){if(this.Yr)return;const e=(null==t?void 0:t.cfg)||In.ee()||{},n=this.Hr(e);this.Qr=new Set(n);const r=e.intg;await Promise.all(n.map(async t=>{const e=Xn[t];if(!e)return;const n=await e();this.Kr.set(t,n);const i=null==r?void 0:r[t];"object"==typeof i&&null!==i?n.tt(i):n.tt()})),this.Yr=!0}Hr(t){const e=[],n=t.intg;if(!n)return e;for(const r of Object.keys(Xn)){const t=n[r];(!0===t||"object"==typeof t&&null!==t)&&e.push(r)}return e}$r(t){if(!t)return;const e=t.csync;e&&this.Gr(e)}async Dr(){try{for(const e of this.Qr){const n=this.Kr.get(e);if(n&&"function"==typeof n.Vr)try{if(await n.Vr())return!0}catch(t){p(`cookie_sync_check_error: ${t instanceof Error?t.message:String(t)}`,"subscriber-manager")}}return!1}catch(e){return p(`cookie_sync_check_error: ${e instanceof Error?e.message:String(e)}`,"subscriber-manager"),!1}}Gr(t){const e=t.dt;e&&"string"==typeof e&&this.Qr.forEach(e=>{const n=this.Kr.get(e);n&&this.Xr(e,n,t).catch(()=>{})})}async Xr(t,e,n){let r=0;for(;r<=3;){if(r++,e.Wr())return await e.Zr(n),void 0;await new Promise(t=>Ot(t,1e4))}throw new Error(`Third-party script not available for ${t} after ${r} attempts`)}pe(){this.Qr.forEach(t=>{const e=this.Kr.get(t);e&&"pe"in e&&"function"==typeof e.pe&&e.pe()}),this.Yr=!1,this.Qr.clear()}}const Xn={[Kn]:()=>Promise.resolve().then(()=>er).then(t=>t.ti),[Hn]:()=>Promise.resolve().then(()=>rr).then(t=>t.ei),[Jn]:()=>Promise.resolve().then(()=>sr).then(t=>t.ni),[Gn]:()=>Promise.resolve().then(()=>cr).then(t=>t.ri)},Wn=new Vn,Zn=Object.freeze(Object.defineProperty({__proto__:null,ii:Vn,rt:Wn},Symbol.toStringTag,{value:"Module"})),tr=new class{tt(t){}Wr(){return"undefined"!=typeof window&&void 0!==window.klaviyo}async Zr(t){if(!t[Kn]||!t.dt)return;const e=t.dt,n=t[Kn];this.Wr()&&(await this.si()||this.oi(e,n))}oi(t,e){try{const r=window.klaviyo;if(!(null==r?void 0:r.identify))throw new Error("Klaviyo identify not available");const i={$email:t,oir_csync:(new Date).toUTCString(),...e||{}};try{const t=r.identify(i);t&&"function"==typeof t.then?t.then(()=>{this.ci()}).catch(t=>{p(`klaviyo_identify_failed: ${t instanceof Error?t.message:String(t)}`,"klaviyo")}):this.ci()}catch(n){p(`klaviyo_identify_failed: ${n instanceof Error?n.message:String(n)}`,"klaviyo")}}catch(r){p(`klaviyo_sync_failed: ${r instanceof Error?r.message:String(r)}`,"klaviyo")}}ci(){const t=this.ai(),e=new CustomEvent("onKlaviyoSync",{detail:{$exchange_id:t,timestamp:Date.now()}});fn.fn("onKlaviyoSync",e)}ai(){try{const t=i();return t||(this.ui()||null)}catch{return null}}ui(){var t,e;try{const n=window._learnq;return(null==(e=null==(t=null==n?void 0:n.push)?void 0:t.call(n,["_getIdentifiers"]))?void 0:e.$exchange_id)||null}catch{return null}}async si(){try{const t=window.klaviyo;return!!(null==t?void 0:t.isIdentified)&&await t.isIdentified()}catch{return!1}}async Vr(){try{return!(await this.si())}catch(t){return p(`klaviyo_cookie_sync_check_error: ${t instanceof Error?t.message:String(t)}`,"klaviyo"),!1}}pe(){}},er=Object.freeze(Object.defineProperty({__proto__:null,ti:tr},Symbol.toStringTag,{value:"Module"})),nr=new class{tt(t){}Wr(){return"undefined"!=typeof window&&void 0!==window._Sendlane}async Zr(t){if(!t[Hn]||!t.dt)return;const e=t.dt,n=t[Hn];this.Wr()&&(await this.si()||await this.li(e,n))}async li(t,e){try{const r=window._Sendlane;if(!(null==r?void 0:r.push))throw new Error("Sendlane push not available");const i={event:"identify",email:t,oir_csync:(new Date).toUTCString(),...e||{}};try{r.push(i),await this.hi(),this.fi()}catch(n){p(`sendlane_identify_failed: ${n instanceof Error?n.message:String(n)}`,"sendlane")}}catch(r){p(`sendlane_sync_failed: ${r instanceof Error?r.message:String(r)}`,"sendlane")}}async hi(){try{Ve.q(Kt,"synced")}catch(t){p(`sendlane_sync_complete_mark_failed: ${t instanceof Error?t.message:String(t)}`,"sendlane")}}fi(){const t=new CustomEvent("onSendlaneSync",{detail:{timestamp:Date.now()}});void fn.fn("onSendlaneSync",t)}async si(){try{return"synced"===Ve.o(Kt)}catch{return!1}}async Vr(){try{return!(await this.si())}catch(t){return p(`sendlane_cookie_sync_check_error: ${t instanceof Error?t.message:String(t)}`,"sendlane"),!1}}pe(){}},rr=Object.freeze(Object.defineProperty({__proto__:null,ei:nr},Symbol.toStringTag,{value:"Module"})),ir=new class{tt(t){}Wr(){return"undefined"!=typeof window&&void 0!==window.smsbump}async Zr(t){if(!t[Jn]||!t.dt)return;const e=t.dt,n=t[Jn];this.Wr()&&(await this.si()||this.di(e,n))}di(t,e){try{const r=window.smsbump;if(!(null==r?void 0:r.identify))throw new Error("Yotpo smsbump identify not available");const i={email:t,oir_csync:(new Date).toUTCString(),...e||{}};try{r.identify(i).then(()=>{this.yi()}).catch(t=>{p(`yotpo_identify_failed: ${t instanceof Error?t.message:String(t)}`,"yotpo")})}catch(n){p(`yotpo_identify_failed: ${n instanceof Error?n.message:String(n)}`,"yotpo")}}catch(r){p(`yotpo_sync_failed: ${r instanceof Error?r.message:String(r)}`,"yotpo")}}yi(){const t=new CustomEvent("onYotpoSync",{detail:{timestamp:Date.now()}});void fn.fn("onYotpoSync",t)}async si(){try{const t=window.smsbump;return!!(null==t?void 0:t.isIdentified)&&t.isIdentified()}catch{return!1}}async Vr(){try{return!(await this.si())}catch(t){return p(`yotpo_cookie_sync_check_error: ${t instanceof Error?t.message:String(t)}`,"yotpo"),!1}}pe(){}},sr=Object.freeze(Object.defineProperty({__proto__:null,ni:ir},Symbol.toStringTag,{value:"Module"})),or=new class{tt(t){t&&"string"==typeof t._i&&(this.wi=t._i)}Wr(){return"undefined"!=typeof window&&void 0!==window.exponea}async Zr(t){if(!t[Gn]||!t.dt)return;const e=t.dt,n=t[Gn],{_i:r,...i}=n||{},s=r;s&&this.Wr()&&(await this.si(s)||await this.pi(e,s,Object.keys(i).length>0?i:void 0))}async pi(t,e,n){try{const i=window.exponea;if(!(null==i?void 0:i.identify))throw new Error("Bloomreach exponea identify not available");const s={[e]:t},o={email:t,oir_csync:(new Date).toUTCString(),...n||{}};try{i.identify(s,o,()=>{this.hi(),this.gi()})}catch(r){p(`bloomreach_identify_failed: ${r instanceof Error?r.message:String(r)}`,"bloomreach")}}catch(i){p(`bloomreach_sync_failed: ${i instanceof Error?i.message:String(i)}`,"bloomreach")}}ai(){return Promise.resolve(s())}async hi(){try{Ve.q(Qt,"synced")}catch(t){p(`bloomreach_sync_complete_mark_failed: ${t instanceof Error?t.message:String(t)}`,"bloomreach")}}gi(){const t=new CustomEvent("onBloomreachSync",{detail:{timestamp:Date.now()}});void fn.fn("onBloomreachSync",t)}async si(t){var e,n;try{const r=t||this.wi;if(!r)return"synced"===Ve.o(Qt);const i=null==(n=null==(e=window.exponea)?void 0:e.configuration)?void 0:n.customer;return!(!i||!i[r])||"synced"===Ve.o(Qt)}catch{return!1}}async Vr(t){try{const e=t||this.wi;return e?!(await this.si(e)):"synced"!==Ve.o(Qt)}catch(e){return p(`bloomreach_cookie_sync_check_error: ${e instanceof Error?e.message:String(e)}`,"bloomreach"),!1}}pe(){}},cr=Object.freeze(Object.defineProperty({__proto__:null,ri:or},Symbol.toStringTag,{value:"Module"}))}();
